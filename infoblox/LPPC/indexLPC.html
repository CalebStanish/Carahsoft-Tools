<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKU Search</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>
    <h1>SKU Search</h1>
    <input type="file" id="upload" accept=".xlsx">
    <input type="text" id="search" placeholder="Enter SKU">
    <button onclick="searchSKU()">Search</button>
    <p id="output"></p>

    <script>
        let skuData = {};
        const categoryMap = {
            "Subscription Software": ["Subscription", "Partner Subscription", "SaaS (Software as a Service)", "Subscriptions - Data Feed", "Software Perpetual"],
            "Maintenance Services": ["Maintenance Enterprise Direct", "Maintenance Enterprise Partner", "Maintenance ISP Partner", "Maintenance ISP Direct", "Maintenance MSP Direct", "Maintenance (General Category)"],
            "Hardware": ["Hardware"],
            "Professional Services & Training": ["Professional Services & Training"]
        };

        document.getElementById('upload').addEventListener('change', function(event) {
            let file = event.target.files[0];
            let reader = new FileReader();

            reader.onload = function(e) {
                let data = new Uint8Array(e.target.result);
                let workbook = XLSX.read(data, { type: 'array' });
                let sheet = workbook.Sheets[workbook.SheetNames[0]];
                let json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                
                json.slice(1).forEach(row => {
                    if (row[0] && row[1]) {
                        skuData[row[0]] = row[1];
                    }
                });
                alert('File uploaded successfully!');
            };

            reader.readAsArrayBuffer(file);
        });

        function categorizeType(type) {
            for (let category in categoryMap) {
                if (categoryMap[category].includes(type)) {
                    return category;
                }
            }
            return "Unknown Category";
        }

        function searchSKU() {
            let sku = document.getElementById('search').value.trim();
            let output = document.getElementById('output');
            
            if (skuData[sku]) {
                let category = categorizeType(skuData[sku]);
                output.innerText = `Category: ${category}`;
            } else {
                output.innerText = "SKU not found.";
            }
        }
    </script>
</body>
</html>

