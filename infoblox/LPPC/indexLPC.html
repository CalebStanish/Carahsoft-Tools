<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SKU Search</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
</head>
<body>
    <h1>SKU Search</h1>
    <textarea id="search" placeholder="Enter SKUs (one per line)" rows="6" cols="50"></textarea>
    <button onclick="searchSKUs()">Search</button>
    <div id="output"></div>

    <script>
        let skuData = {};
        const categoryMap = {
            "Subscription Software": ["Subscription", "Partner Subscription", "SaaS (Software as a Service)", "Subscriptions - Data Feed", "Software Perpetual"],
            "Maintenance Services": ["Maintenance Enterprise Direct", "Maintenance Enterprise Partner", "Maintenance ISP Partner", "Maintenance ISP Direct", "Maintenance MSP Direct", "Maintenance (General Category)"],
            "Hardware": ["Hardware"],
            "Professional Services & Training": ["Professional Services & Training"]
        };

        fetch('infobloxskudata.xlsx')
            .then(response => response.arrayBuffer())
            .then(data => {
                let workbook = XLSX.read(data, { type: 'array' });
                let sheet = workbook.Sheets[workbook.SheetNames[0]];
                let json = XLSX.utils.sheet_to_json(sheet, { header: 1 });
                
                json.slice(1).forEach(row => {
                    if (row[0] && row[1]) {
                        skuData[row[0]] = row[1];
                    }
                });
                console.log('File loaded successfully!');
            })
            .catch(error => console.error('Error loading the file:', error));

        function categorizeType(type) {
            for (let category in categoryMap) {
                if (categoryMap[category].includes(type)) {
                    return category;
                }
            }
            return "Unknown Category";
        }

        function searchSKUs() {
            let input = document.getElementById('search').value.trim();
            let skus = input.split(/\r?\n/).map(s => s.trim());
            let output = document.getElementById('output');
            output.innerHTML = "";

            skus.forEach(sku => {
                if (skuData[sku]) {
                    let category = categorizeType(skuData[sku]);
                    output.innerHTML += `<p>SKU: ${sku} - Category: ${category}</p>`;
                } else {
                    output.innerHTML += `<p>SKU: ${sku} - Not found</p>`;
                }
            });
        }
    </script>
</body>
</html>
