<script>
  // Exact match search: Column B first, then Column J
  function exactMatchSearch(query) {
    const q = query.trim().toLowerCase();
    if (!q) return [];

    // First try exact in Column B
    const matchB = rows.find(r => r.nameB.toLowerCase() === q);
    if (matchB) return [matchB];

    // Then try exact in Column J
    const matchJ = rows.find(r => r.nameJ.toLowerCase() === q);
    if (matchJ) return [matchJ];

    // No exact match
    return [];
  }

  function renderResults(list, query) {
    const wrap = document.getElementById('results');
    if (!list.length) {
      wrap.innerHTML = `<p>No exact match found for <b>${escapeHtml(query)}</b>.</p>`;
      return;
    }
    const r = list[0];
    wrap.innerHTML = `
      <table>
        <thead>
          <tr><th>SKU (A)</th><th>Product Name</th><th>Annual Price (E)</th></tr>
        </thead>
        <tbody>
          <tr>
            <td>${escapeHtml(r.sku)}</td>
            <td>${escapeHtml(r.nameB || r.nameJ)}</td>
            <td>${fmtUSD(r.priceE)}</td>
          </tr>
        </tbody>
      </table>`;
  }

  // Wire up UI
  const input = document.getElementById('query');
  const btn = document.getElementById('searchBtn');
  btn.addEventListener('click', () => {
    const q = input.value;
    renderResults(exactMatchSearch(q), q);
  });
  input.addEventListener('keydown', e => {
    if (e.key === 'Enter' && !btn.disabled) btn.click();
  });
</script>


